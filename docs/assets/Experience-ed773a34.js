import{r as l,T as Gs,a as Ns,b as zs,R as ht,u as re,M as xe,_ as Te,c as Yn,I as qs,S as Hs,D as Ks,d as Qs,H as Ie,F as mt,e as $e,L as Xn,f as sn,g as Lt,h as Ws,W as Ys,i as Xs,j as Zn,k as Zs,C as Js,E as ei,s as ti,l as ni,m as rn,n as Ve,G as si,o as ii,p as ri,V as Jn,Q as oi,q as es,t as ai,v as Qe,w as ci,x as F,y as ui}from"./index-2b7fac79.js";import{p as ye}from"./index-4d501b15.js";function Ft(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}let Bt=Fe();const M=t=>Le(t,Bt);let Ut=Fe();M.write=t=>Le(t,Ut);let it=Fe();M.onStart=t=>Le(t,it);let jt=Fe();M.onFrame=t=>Le(t,jt);let $t=Fe();M.onFinish=t=>Le(t,$t);let de=[];M.setTimeout=(t,e)=>{let n=M.now()+e,s=()=>{let r=de.findIndex(o=>o.cancel==s);~r&&de.splice(r,1),ne-=~r?1:0},i={time:n,handler:t,cancel:s};return de.splice(ts(n),0,i),ne+=1,ns(),i};let ts=t=>~(~de.findIndex(e=>e.time>t)||~de.length);M.cancel=t=>{it.delete(t),jt.delete(t),$t.delete(t),Bt.delete(t),Ut.delete(t)};M.sync=t=>{Et=!0,M.batchedUpdates(t),Et=!1};M.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function s(...i){e=i,M.onStart(n)}return s.handler=t,s.cancel=()=>{it.delete(n),e=null},s};let Gt=typeof window<"u"?window.requestAnimationFrame:()=>{};M.use=t=>Gt=t;M.now=typeof performance<"u"?()=>performance.now():Date.now;M.batchedUpdates=t=>t();M.catch=console.error;M.frameLoop="always";M.advance=()=>{M.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):is()};let te=-1,ne=0,Et=!1;function Le(t,e){Et?(e.delete(t),t(0)):(e.add(t),ns())}function ns(){te<0&&(te=0,M.frameLoop!=="demand"&&Gt(ss))}function fi(){te=-1}function ss(){~te&&(Gt(ss),M.batchedUpdates(is))}function is(){let t=te;te=M.now();let e=ts(te);if(e&&(rs(de.splice(0,e),n=>n.handler()),ne-=e),!ne){fi();return}it.flush(),Bt.flush(t?Math.min(64,te-t):16.667),jt.flush(),Ut.flush(),$t.flush()}function Fe(){let t=new Set,e=t;return{add(n){ne+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return ne-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,ne-=e.size,rs(e,s=>s(n)&&t.add(s)),ne+=t.size,e=t)}}}function rs(t,e){t.forEach(n=>{try{e(n)}catch(s){M.catch(s)}})}function xt(){}const li=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),h={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Z(t,e){if(h.arr(t)){if(!h.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}const k=(t,e)=>t.forEach(e);function J(t,e,n){if(h.arr(t)){for(let s=0;s<t.length;s++)e.call(n,t[s],`${s}`);return}for(const s in t)t.hasOwnProperty(s)&&e.call(n,t[s],s)}const $=t=>h.und(t)?[]:h.arr(t)?t:[t];function Pe(t,e){if(t.size){const n=Array.from(t);t.clear(),k(n,e)}}const Se=(t,...e)=>Pe(t,n=>n(...e)),Nt=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let zt,os,se=null,as=!1,qt=xt;const di=t=>{t.to&&(os=t.to),t.now&&(M.now=t.now),t.colors!==void 0&&(se=t.colors),t.skipAnimation!=null&&(as=t.skipAnimation),t.createStringInterpolator&&(zt=t.createStringInterpolator),t.requestAnimationFrame&&M.use(t.requestAnimationFrame),t.batchedUpdates&&(M.batchedUpdates=t.batchedUpdates),t.willAdvance&&(qt=t.willAdvance),t.frameLoop&&(M.frameLoop=t.frameLoop)};var K=Object.freeze({__proto__:null,get createStringInterpolator(){return zt},get to(){return os},get colors(){return se},get skipAnimation(){return as},get willAdvance(){return qt},assign:di});const Ae=new Set;let j=[],pt=[],We=0;const rt={get idle(){return!Ae.size&&!j.length},start(t){We>t.priority?(Ae.add(t),M.onStart(hi)):(cs(t),M(It))},advance:It,sort(t){if(We)M.onFrame(()=>rt.sort(t));else{const e=j.indexOf(t);~e&&(j.splice(e,1),us(t))}},clear(){j=[],Ae.clear()}};function hi(){Ae.forEach(cs),Ae.clear(),M(It)}function cs(t){j.includes(t)||us(t)}function us(t){j.splice(mi(j,e=>e.priority>t.priority),0,t)}function It(t){const e=pt;for(let n=0;n<j.length;n++){const s=j[n];We=s.priority,s.idle||(qt(s),s.advance(t),s.idle||e.push(s))}return We=0,pt=j,pt.length=0,j=e,j.length>0}function mi(t,e){const n=t.findIndex(e);return n<0?t.length:n}const pi=(t,e,n)=>Math.min(Math.max(n,t),e),gi={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},z="[-+]?\\d*\\.?\\d+",Ye=z+"%";function ot(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const _i=new RegExp("rgb"+ot(z,z,z)),yi=new RegExp("rgba"+ot(z,z,z,z)),vi=new RegExp("hsl"+ot(z,Ye,Ye)),bi=new RegExp("hsla"+ot(z,Ye,Ye,z)),wi=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Ei=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,xi=/^#([0-9a-fA-F]{6})$/,Ii=/^#([0-9a-fA-F]{8})$/;function Si(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=xi.exec(t))?parseInt(e[1]+"ff",16)>>>0:se&&se[t]!==void 0?se[t]:(e=_i.exec(t))?(ue(e[1])<<24|ue(e[2])<<16|ue(e[3])<<8|255)>>>0:(e=yi.exec(t))?(ue(e[1])<<24|ue(e[2])<<16|ue(e[3])<<8|cn(e[4]))>>>0:(e=wi.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Ii.exec(t))?parseInt(e[1],16)>>>0:(e=Ei.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=vi.exec(t))?(on(an(e[1]),Ge(e[2]),Ge(e[3]))|255)>>>0:(e=bi.exec(t))?(on(an(e[1]),Ge(e[2]),Ge(e[3]))|cn(e[4]))>>>0:null}function gt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function on(t,e,n){const s=n<.5?n*(1+e):n+e-n*e,i=2*n-s,r=gt(i,s,t+1/3),o=gt(i,s,t),a=gt(i,s,t-1/3);return Math.round(r*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function ue(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function an(t){return(parseFloat(t)%360+360)%360/360}function cn(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function Ge(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function un(t){let e=Si(t);if(e===null)return t;e=e||0;let n=(e&4278190080)>>>24,s=(e&16711680)>>>16,i=(e&65280)>>>8,r=(e&255)/255;return`rgba(${n}, ${s}, ${i}, ${r})`}const Re=(t,e,n)=>{if(h.fun(t))return t;if(h.arr(t))return Re({range:t,output:e,extrapolate:n});if(h.str(t.output[0]))return zt(t);const s=t,i=s.output,r=s.range||[0,1],o=s.extrapolateLeft||s.extrapolate||"extend",a=s.extrapolateRight||s.extrapolate||"extend",u=s.easing||(c=>c);return c=>{const f=Ai(c,r);return Pi(c,r[f],r[f+1],i[f],i[f+1],u,o,a,s.map)}};function Pi(t,e,n,s,i,r,o,a,u){let c=u?u(t):t;if(c<e){if(o==="identity")return c;o==="clamp"&&(c=e)}if(c>n){if(a==="identity")return c;a==="clamp"&&(c=n)}return s===i?s:e===n?t<=e?s:i:(e===-1/0?c=-c:n===1/0?c=c-e:c=(c-e)/(n-e),c=r(c),s===-1/0?c=-c:i===1/0?c=c+s:c=c*(i-s)+s,c)}function Ai(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}const Mi=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const s=n*t,i=e==="end"?Math.floor(s):Math.ceil(s);return pi(0,1,i/t)},Xe=1.70158,Ne=Xe*1.525,fn=Xe+1,ln=2*Math.PI/3,dn=2*Math.PI/4.5,ze=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,Ti={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>fn*t*t*t-Xe*t*t,easeOutBack:t=>1+fn*Math.pow(t-1,3)+Xe*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Ne+1)*2*t-Ne)/2:(Math.pow(2*t-2,2)*((Ne+1)*(t*2-2)+Ne)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*ln),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*ln)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*dn))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*dn)/2+1,easeInBounce:t=>1-ze(1-t),easeOutBounce:ze,easeInOutBounce:t=>t<.5?(1-ze(1-2*t))/2:(1+ze(2*t-1))/2,steps:Mi};function St(){return St=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},St.apply(this,arguments)}const me=Symbol.for("FluidValue.get"),oe=Symbol.for("FluidValue.observers"),H=t=>!!(t&&t[me]),B=t=>t&&t[me]?t[me]():t,hn=t=>t[oe]||null;function Ri(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Ze(t,e){let n=t[oe];n&&n.forEach(s=>{Ri(s,e)})}class ki{constructor(e){if(this[me]=void 0,this[oe]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");Ci(this,e)}}const Ci=(t,e)=>fs(t,me,e);function Be(t,e){if(t[me]){let n=t[oe];n||fs(t,oe,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function Je(t,e){let n=t[oe];if(n&&n.has(e)){const s=n.size-1;s?n.delete(e):t[oe]=null,t.observerRemoved&&t.observerRemoved(s,e)}}const fs=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),He=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Oi=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,mn=new RegExp(`(${He.source})(%|[a-z]+)`,"i"),Di=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,at=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,ls=t=>{const[e,n]=Vi(t);if(!e||Nt())return t;const s=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(s)return s.trim();if(n&&n.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(n);return i||t}else{if(n&&at.test(n))return ls(n);if(n)return n}return t},Vi=t=>{const e=at.exec(t);if(!e)return[,];const[,n,s]=e;return[n,s]};let _t;const Li=(t,e,n,s,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(s)}, ${i})`,ds=t=>{_t||(_t=se?new RegExp(`(${Object.keys(se).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(r=>B(r).replace(at,ls).replace(Oi,un).replace(_t,un)),n=e.map(r=>r.match(He).map(Number)),i=n[0].map((r,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(r=>Re(St({},t,{output:r})));return r=>{var o;const a=!mn.test(e[0])&&((o=e.find(c=>mn.test(c)))==null?void 0:o.replace(He,""));let u=0;return e[0].replace(He,()=>`${i[u++](r)}${a||""}`).replace(Di,Li)}},Ht="react-spring: ",hs=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${Ht}once requires a function parameter`);return(...s)=>{n||(e(...s),n=!0)}},Fi=hs(console.warn);function Bi(){Fi(`${Ht}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const Ui=hs(console.warn);function ji(){Ui(`${Ht}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function ct(t){return h.str(t)&&(t[0]=="#"||/\d/.test(t)||!Nt()&&at.test(t)||t in(se||{}))}const Kt=Nt()?l.useEffect:l.useLayoutEffect,$i=()=>{const t=l.useRef(!1);return Kt(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function ms(){const t=l.useState()[1],e=$i();return()=>{e.current&&t(Math.random())}}function Gi(t,e){const[n]=l.useState(()=>({inputs:e,result:t()})),s=l.useRef(),i=s.current;let r=i;return r?e&&r.inputs&&Ni(e,r.inputs)||(r={inputs:e,result:t()}):r=n,l.useEffect(()=>{s.current=r,i==n&&(n.inputs=n.result=void 0)},[r]),r.result}function Ni(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const ps=t=>l.useEffect(t,zi),zi=[];function pn(t){const e=l.useRef();return l.useEffect(()=>{e.current=t}),e.current}const ke=Symbol.for("Animated:node"),qi=t=>!!t&&t[ke]===t,q=t=>t&&t[ke],Qt=(t,e)=>li(t,ke,e),ut=t=>t&&t[ke]&&t[ke].getPayload();class gs{constructor(){this.payload=void 0,Qt(this,this)}getPayload(){return this.payload||[]}}class _e extends gs{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,h.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new _e(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,n){return h.num(e)&&(this.lastPosition=e,n&&(e=Math.round(e/n)*n,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,h.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class pe extends _e{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=Re({output:[e,e]})}static create(e){return new pe(e)}getValue(){let e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(h.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Re({output:[this.getValue(),e]})),this._value=0,super.reset()}}const et={dependencies:null};class Wt extends gs{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const n={};return J(this.source,(s,i)=>{qi(s)?n[i]=s.getValue(e):H(s)?n[i]=B(s):e||(n[i]=s)}),n}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&k(this.payload,e=>e.reset())}_makePayload(e){if(e){const n=new Set;return J(e,this._addToPayload,n),Array.from(n)}}_addToPayload(e){et.dependencies&&H(e)&&et.dependencies.add(e);const n=ut(e);n&&k(n,s=>this.add(s))}}class Yt extends Wt{constructor(e){super(e)}static create(e){return new Yt(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const n=this.getPayload();return e.length==n.length?n.map((s,i)=>s.setValue(e[i])).some(Boolean):(super.setValue(e.map(Hi)),!0)}}function Hi(t){return(ct(t)?pe:_e).create(t)}function Pt(t){const e=q(t);return e?e.constructor:h.arr(t)?Yt:ct(t)?pe:_e}function tt(){return tt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},tt.apply(this,arguments)}const gn=(t,e)=>{const n=!h.fun(t)||t.prototype&&t.prototype.isReactComponent;return l.forwardRef((s,i)=>{const r=l.useRef(null),o=n&&l.useCallback(v=>{r.current=Wi(i,v)},[i]),[a,u]=Qi(s,e),c=ms(),f=()=>{const v=r.current;if(n&&!v)return;(v?e.applyAnimatedValues(v,a.getValue(!0)):!1)===!1&&c()},p=new Ki(f,u),g=l.useRef();Kt(()=>(g.current=p,k(u,v=>Be(v,p)),()=>{g.current&&(k(g.current.deps,v=>Je(v,g.current)),M.cancel(g.current.update))})),l.useEffect(f,[]),ps(()=>()=>{const v=g.current;k(v.deps,b=>Je(b,v))});const x=e.getComponentProps(a.getValue());return l.createElement(t,tt({},x,{ref:o}))})};class Ki{constructor(e,n){this.update=e,this.deps=n}eventObserved(e){e.type=="change"&&M.write(this.update)}}function Qi(t,e){const n=new Set;return et.dependencies=n,t.style&&(t=tt({},t,{style:e.createAnimatedStyle(t.style)})),t=new Wt(t),et.dependencies=null,[t,n]}function Wi(t,e){return t&&(h.fun(t)?t(e):t.current=e),e}const _n=Symbol.for("AnimatedComponent"),Yi=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=i=>new Wt(i),getComponentProps:s=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:s},r=o=>{const a=yn(o)||"Anonymous";return h.str(o)?o=r[o]||(r[o]=gn(o,i)):o=o[_n]||(o[_n]=gn(o,i)),o.displayName=`Animated(${a})`,o};return J(t,(o,a)=>{h.arr(t)&&(a=yn(o)),r[a]=r(o)}),{animated:r}},yn=t=>h.str(t)?t:t&&h.str(t.displayName)?t.displayName:h.fun(t)&&t.name||null;function L(){return L=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},L.apply(this,arguments)}function ie(t,...e){return h.fun(t)?t(...e):t}const Me=(t,e)=>t===!0||!!(e&&t&&(h.fun(t)?t(e):$(t).includes(e))),_s=(t,e)=>h.obj(t)?e&&t[e]:t,ys=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,Xi=t=>t,Xt=(t,e=Xi)=>{let n=Zi;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const s={};for(const i of n){const r=e(t[i],i);h.und(r)||(s[i]=r)}return s},Zi=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Ji={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function er(t){const e={};let n=0;if(J(t,(s,i)=>{Ji[i]||(e[i]=s,n++)}),n)return e}function vs(t){const e=er(t);if(e){const n={to:e};return J(t,(s,i)=>i in e||(n[i]=s)),n}return L({},t)}function Ce(t){return t=B(t),h.arr(t)?t.map(Ce):ct(t)?K.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function tr(t){for(const e in t)return!0;return!1}function At(t){return h.fun(t)||h.arr(t)&&h.obj(t[0])}function nr(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function sr(t,e){if(e&&t.ref!==e){var n;(n=t.ref)==null||n.delete(t),e.add(t),t.ref=e}}const ir={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Mt=L({},ir.default,{mass:1,damping:1,easing:Ti.linear,clamp:!1});class rr{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,Mt)}}function or(t,e,n){n&&(n=L({},n),vn(n,e),e=L({},n,e)),vn(t,e),Object.assign(t,e);for(const o in Mt)t[o]==null&&(t[o]=Mt[o]);let{mass:s,frequency:i,damping:r}=t;return h.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function vn(t,e){if(!h.und(e.decay))t.duration=void 0;else{const n=!h.und(e.tension)||!h.und(e.friction);(n||!h.und(e.frequency)||!h.und(e.damping)||!h.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}const bn=[];class ar{constructor(){this.changed=!1,this.values=bn,this.toValues=null,this.fromValues=bn,this.to=void 0,this.from=void 0,this.config=new rr,this.immediate=!1}}function bs(t,{key:e,props:n,defaultProps:s,state:i,actions:r}){return new Promise((o,a)=>{var u;let c,f,p=Me((u=n.cancel)!=null?u:s==null?void 0:s.cancel,e);if(p)v();else{h.und(n.pause)||(i.paused=Me(n.pause,e));let b=s==null?void 0:s.pause;b!==!0&&(b=i.paused||Me(b,e)),c=ie(n.delay||0,e),b?(i.resumeQueue.add(x),r.pause()):(r.resume(),x())}function g(){i.resumeQueue.add(x),i.timeouts.delete(f),f.cancel(),c=f.time-M.now()}function x(){c>0&&!K.skipAnimation?(i.delayed=!0,f=M.setTimeout(v,c),i.pauseQueue.add(g),i.timeouts.add(f)):v()}function v(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(g),i.timeouts.delete(f),t<=(i.cancelId||0)&&(p=!0);try{r.start(L({},n,{callId:t,cancel:p}),o)}catch(b){a(b)}}})}const Zt=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?he(t.get()):e.every(n=>n.noop)?ws(t.get()):N(t.get(),e.every(n=>n.finished)),ws=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),N=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),he=t=>({value:t,cancelled:!0,finished:!1});function Es(t,e,n,s){const{callId:i,parentId:r,onRest:o}=e,{asyncTo:a,promise:u}=n;return!r&&t===a&&!e.reset?u:n.promise=(async()=>{n.asyncId=i,n.asyncTo=t;const c=Xt(e,(m,_)=>_==="onRest"?void 0:m);let f,p;const g=new Promise((m,_)=>(f=m,p=_)),x=m=>{const _=i<=(n.cancelId||0)&&he(s)||i!==n.asyncId&&N(s,!1);if(_)throw m.result=_,p(m),m},v=(m,_)=>{const w=new wn,d=new En;return(async()=>{if(K.skipAnimation)throw Oe(n),d.result=N(s,!1),p(d),d;x(w);const y=h.obj(m)?L({},m):L({},_,{to:m});y.parentId=i,J(c,(E,T)=>{h.und(y[T])&&(y[T]=E)});const I=await s.start(y);return x(w),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),I})()};let b;if(K.skipAnimation)return Oe(n),N(s,!1);try{let m;h.arr(t)?m=(async _=>{for(const w of _)await v(w)})(t):m=Promise.resolve(t(v,s.stop.bind(s))),await Promise.all([m.then(f),g]),b=N(s.get(),!0,!1)}catch(m){if(m instanceof wn)b=m.result;else if(m instanceof En)b=m.result;else throw m}finally{i==n.asyncId&&(n.asyncId=r,n.asyncTo=r?a:void 0,n.promise=r?u:void 0)}return h.fun(o)&&M.batchedUpdates(()=>{o(b,s,s.item)}),b})()}function Oe(t,e){Pe(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}class wn extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class En extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const Tt=t=>t instanceof Jt;let cr=1;class Jt extends ki{constructor(...e){super(...e),this.id=cr++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=q(this);return e&&e.getValue()}to(...e){return K.to(this,e)}interpolate(...e){return Bi(),K.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,n=!1){Ze(this,{type:"change",parent:this,value:e,idle:n})}_onPriorityChange(e){this.idle||rt.sort(this),Ze(this,{type:"priority",parent:this,priority:e})}}const ae=Symbol.for("SpringPhase"),xs=1,Rt=2,kt=4,yt=t=>(t[ae]&xs)>0,ee=t=>(t[ae]&Rt)>0,ve=t=>(t[ae]&kt)>0,xn=(t,e)=>e?t[ae]|=Rt|xs:t[ae]&=~Rt,In=(t,e)=>e?t[ae]|=kt:t[ae]&=~kt;class ur extends Jt{constructor(e,n){if(super(),this.key=void 0,this.animation=new ar,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!h.und(e)||!h.und(n)){const s=h.obj(e)?L({},e):L({},n,{from:e});h.und(s.default)&&(s.default=!0),this.start(s)}}get idle(){return!(ee(this)||this._state.asyncTo)||ve(this)}get goal(){return B(this.animation.to)}get velocity(){const e=q(this);return e instanceof _e?e.lastVelocity||0:e.getPayload().map(n=>n.lastVelocity||0)}get hasAnimated(){return yt(this)}get isAnimating(){return ee(this)}get isPaused(){return ve(this)}get isDelayed(){return this._state.delayed}advance(e){let n=!0,s=!1;const i=this.animation;let{config:r,toValues:o}=i;const a=ut(i.to);!a&&H(i.to)&&(o=$(B(i.to))),i.values.forEach((f,p)=>{if(f.done)return;const g=f.constructor==pe?1:a?a[p].lastPosition:o[p];let x=i.immediate,v=g;if(!x){if(v=f.lastPosition,r.tension<=0){f.done=!0;return}let b=f.elapsedTime+=e;const m=i.fromValues[p],_=f.v0!=null?f.v0:f.v0=h.arr(r.velocity)?r.velocity[p]:r.velocity;let w;const d=r.precision||(m==g?.005:Math.min(1,Math.abs(g-m)*.001));if(h.und(r.duration))if(r.decay){const y=r.decay===!0?.998:r.decay,I=Math.exp(-(1-y)*b);v=m+_/(1-y)*(1-I),x=Math.abs(f.lastPosition-v)<=d,w=_*I}else{w=f.lastVelocity==null?_:f.lastVelocity;const y=r.restVelocity||d/10,I=r.clamp?0:r.bounce,E=!h.und(I),T=m==g?f.v0>0:m<g;let P,A=!1;const R=1,S=Math.ceil(e/R);for(let V=0;V<S&&(P=Math.abs(w)>y,!(!P&&(x=Math.abs(g-v)<=d,x)));++V){E&&(A=v==g||v>g==T,A&&(w=-w*I,v=g));const Q=-r.tension*1e-6*(v-g),W=-r.friction*.001*w,G=(Q+W)/r.mass;w=w+G*R,v=v+w*R}}else{let y=1;r.duration>0&&(this._memoizedDuration!==r.duration&&(this._memoizedDuration=r.duration,f.durationProgress>0&&(f.elapsedTime=r.duration*f.durationProgress,b=f.elapsedTime+=e)),y=(r.progress||0)+b/this._memoizedDuration,y=y>1?1:y<0?0:y,f.durationProgress=y),v=m+r.easing(y)*(g-m),w=(v-f.lastPosition)/e,x=y==1}f.lastVelocity=w,Number.isNaN(v)&&(console.warn("Got NaN while animating:",this),x=!0)}a&&!a[p].done&&(x=!1),x?f.done=!0:n=!1,f.setValue(v,r.round)&&(s=!0)});const u=q(this),c=u.getValue();if(n){const f=B(i.to);(c!==f||s)&&!r.decay?(u.setValue(f),this._onChange(f)):s&&r.decay&&this._onChange(c),this._stop()}else s&&this._onChange(c)}set(e){return M.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(ee(this)){const{to:e,config:n}=this.animation;M.batchedUpdates(()=>{this._onStart(),n.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,n){let s;return h.und(e)?(s=this.queue||[],this.queue=[]):s=[h.obj(e)?e:L({},n,{to:e})],Promise.all(s.map(i=>this._update(i))).then(i=>Zt(this,i))}stop(e){const{to:n}=this.animation;return this._focus(this.get()),Oe(this._state,e&&this._lastCallId),M.batchedUpdates(()=>this._stop(n,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const n=this.key||"";let{to:s,from:i}=e;s=h.obj(s)?s[n]:s,(s==null||At(s))&&(s=void 0),i=h.obj(i)?i[n]:i,i==null&&(i=void 0);const r={to:s,from:i};return yt(this)||(e.reverse&&([s,i]=[i,s]),i=B(i),h.und(i)?q(this)||this._set(s):this._set(i)),r}_update(e,n){let s=L({},e);const{key:i,defaultProps:r}=this;s.default&&Object.assign(r,Xt(s,(u,c)=>/^on/.test(c)?_s(u,i):u)),Pn(this,s,"onProps"),we(this,"onProps",s,this);const o=this._prepareNode(s);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const a=this._state;return bs(++this._lastCallId,{key:i,props:s,defaultProps:r,state:a,actions:{pause:()=>{ve(this)||(In(this,!0),Se(a.pauseQueue),we(this,"onPause",N(this,be(this,this.animation.to)),this))},resume:()=>{ve(this)&&(In(this,!1),ee(this)&&this._resume(),Se(a.resumeQueue),we(this,"onResume",N(this,be(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(u=>{if(s.loop&&u.finished&&!(n&&u.noop)){const c=Is(s);if(c)return this._update(c,!0)}return u})}_merge(e,n,s){if(n.cancel)return this.stop(!0),s(he(this));const i=!h.und(e.to),r=!h.und(e.from);if(i||r)if(n.callId>this._lastToId)this._lastToId=n.callId;else return s(he(this));const{key:o,defaultProps:a,animation:u}=this,{to:c,from:f}=u;let{to:p=c,from:g=f}=e;r&&!i&&(!n.default||h.und(p))&&(p=g),n.reverse&&([p,g]=[g,p]);const x=!Z(g,f);x&&(u.from=g),g=B(g);const v=!Z(p,c);v&&this._focus(p);const b=At(n.to),{config:m}=u,{decay:_,velocity:w}=m;(i||r)&&(m.velocity=0),n.config&&!b&&or(m,ie(n.config,o),n.config!==a.config?ie(a.config,o):void 0);let d=q(this);if(!d||h.und(p))return s(N(this,!0));const y=h.und(n.reset)?r&&!n.default:!h.und(g)&&Me(n.reset,o),I=y?g:this.get(),E=Ce(p),T=h.num(E)||h.arr(E)||ct(E),P=!b&&(!T||Me(a.immediate||n.immediate,o));if(v){const V=Pt(p);if(V!==d.constructor)if(P)d=this._set(E);else throw Error(`Cannot animate between ${d.constructor.name} and ${V.name}, as the "to" prop suggests`)}const A=d.constructor;let R=H(p),S=!1;if(!R){const V=y||!yt(this)&&x;(v||V)&&(S=Z(Ce(I),E),R=!S),(!Z(u.immediate,P)&&!P||!Z(m.decay,_)||!Z(m.velocity,w))&&(R=!0)}if(S&&ee(this)&&(u.changed&&!y?R=!0:R||this._stop(c)),!b&&((R||H(c))&&(u.values=d.getPayload(),u.toValues=H(p)?null:A==pe?[1]:$(E)),u.immediate!=P&&(u.immediate=P,!P&&!y&&this._set(c)),R)){const{onRest:V}=u;k(lr,W=>Pn(this,n,W));const Q=N(this,be(this,c));Se(this._pendingCalls,Q),this._pendingCalls.add(s),u.changed&&M.batchedUpdates(()=>{u.changed=!y,V==null||V(Q,this),y?ie(a.onRest,Q):u.onStart==null||u.onStart(Q,this)})}y&&this._set(I),b?s(Es(n.to,n,this._state,this)):R?this._start():ee(this)&&!v?this._pendingCalls.add(s):s(ws(I))}_focus(e){const n=this.animation;e!==n.to&&(hn(this)&&this._detach(),n.to=e,hn(this)&&this._attach())}_attach(){let e=0;const{to:n}=this.animation;H(n)&&(Be(n,this),Tt(n)&&(e=n.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;H(e)&&Je(e,this)}_set(e,n=!0){const s=B(e);if(!h.und(s)){const i=q(this);if(!i||!Z(s,i.getValue())){const r=Pt(s);!i||i.constructor!=r?Qt(this,r.create(s)):i.setValue(s),i&&M.batchedUpdates(()=>{this._onChange(s,n)})}}return q(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,we(this,"onStart",N(this,be(this,e.to)),this))}_onChange(e,n){n||(this._onStart(),ie(this.animation.onChange,e,this)),ie(this.defaultProps.onChange,e,this),super._onChange(e,n)}_start(){const e=this.animation;q(this).reset(B(e.to)),e.immediate||(e.fromValues=e.values.map(n=>n.lastPosition)),ee(this)||(xn(this,!0),ve(this)||this._resume())}_resume(){K.skipAnimation?this.finish():rt.start(this)}_stop(e,n){if(ee(this)){xn(this,!1);const s=this.animation;k(s.values,r=>{r.done=!0}),s.toValues&&(s.onChange=s.onPause=s.onResume=void 0),Ze(this,{type:"idle",parent:this});const i=n?he(this.get()):N(this.get(),be(this,e??s.to));Se(this._pendingCalls,i),s.changed&&(s.changed=!1,we(this,"onRest",i,this))}}}function be(t,e){const n=Ce(e),s=Ce(t.get());return Z(s,n)}function Is(t,e=t.loop,n=t.to){let s=ie(e);if(s){const i=s!==!0&&vs(s),r=(i||t).reverse,o=!i||i.reset;return De(L({},t,{loop:e,default:!1,pause:void 0,to:!r||At(n)?n:void 0,from:o?t.from:void 0,reset:o},i))}}function De(t){const{to:e,from:n}=t=vs(t),s=new Set;return h.obj(e)&&Sn(e,s),h.obj(n)&&Sn(n,s),t.keys=s.size?Array.from(s):null,t}function fr(t){const e=De(t);return h.und(e.default)&&(e.default=Xt(e)),e}function Sn(t,e){J(t,(n,s)=>n!=null&&e.add(s))}const lr=["onStart","onRest","onChange","onPause","onResume"];function Pn(t,e,n){t.animation[n]=e[n]!==ys(e,n)?_s(e[n],t.key):void 0}function we(t,e,...n){var s,i,r,o;(s=(i=t.animation)[e])==null||s.call(i,...n),(r=(o=t.defaultProps)[e])==null||r.call(o,...n)}const dr=["onStart","onChange","onRest"];let hr=1,mr=class{constructor(e,n){this.id=hr++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),n&&(this._flush=n),e&&this.start(L({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((n,s)=>e[s]=n.get()),e}set(e){for(const n in e){const s=e[n];h.und(s)||this.springs[n].set(s)}}update(e){return e&&this.queue.push(De(e)),this}start(e){let{queue:n}=this;return e?n=$(e).map(De):this.queue=[],this._flush?this._flush(this,n):(Ts(this,n),Ct(this,n))}stop(e,n){if(e!==!!e&&(n=e),n){const s=this.springs;k($(n),i=>s[i].stop(!!e))}else Oe(this._state,this._lastAsyncId),this.each(s=>s.stop(!!e));return this}pause(e){if(h.und(e))this.start({pause:!0});else{const n=this.springs;k($(e),s=>n[s].pause())}return this}resume(e){if(h.und(e))this.start({pause:!1});else{const n=this.springs;k($(e),s=>n[s].resume())}return this}each(e){J(this.springs,e)}_onFrame(){const{onStart:e,onChange:n,onRest:s}=this._events,i=this._active.size>0,r=this._changed.size>0;(i&&!this._started||r&&!this._started)&&(this._started=!0,Pe(e,([u,c])=>{c.value=this.get(),u(c,this,this._item)}));const o=!i&&this._started,a=r||o&&s.size?this.get():null;r&&n.size&&Pe(n,([u,c])=>{c.value=a,u(c,this,this._item)}),o&&(this._started=!1,Pe(s,([u,c])=>{c.value=a,u(c,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;M.onFrame(this._onFrame)}};function Ct(t,e){return Promise.all(e.map(n=>Ss(t,n))).then(n=>Zt(t,n))}async function Ss(t,e,n){const{keys:s,to:i,from:r,loop:o,onRest:a,onResolve:u}=e,c=h.obj(e.default)&&e.default;o&&(e.loop=!1),i===!1&&(e.to=null),r===!1&&(e.from=null);const f=h.arr(i)||h.fun(i)?i:void 0;f?(e.to=void 0,e.onRest=void 0,c&&(c.onRest=void 0)):k(dr,b=>{const m=e[b];if(h.fun(m)){const _=t._events[b];e[b]=({finished:w,cancelled:d})=>{const y=_.get(m);y?(w||(y.finished=!1),d&&(y.cancelled=!0)):_.set(m,{value:null,finished:w||!1,cancelled:d||!1})},c&&(c[b]=e[b])}});const p=t._state;e.pause===!p.paused?(p.paused=e.pause,Se(e.pause?p.pauseQueue:p.resumeQueue)):p.paused&&(e.pause=!0);const g=(s||Object.keys(t.springs)).map(b=>t.springs[b].start(e)),x=e.cancel===!0||ys(e,"cancel")===!0;(f||x&&p.asyncId)&&g.push(bs(++t._lastAsyncId,{props:e,state:p,actions:{pause:xt,resume:xt,start(b,m){x?(Oe(p,t._lastAsyncId),m(he(t))):(b.onRest=a,m(Es(f,b,p,t)))}}})),p.paused&&await new Promise(b=>{p.resumeQueue.add(b)});const v=Zt(t,await Promise.all(g));if(o&&v.finished&&!(n&&v.noop)){const b=Is(e,o,i);if(b)return Ts(t,[b]),Ss(t,b,!0)}return u&&M.batchedUpdates(()=>u(v,t,t.item)),v}function An(t,e){const n=L({},t.springs);return e&&k($(e),s=>{h.und(s.keys)&&(s=De(s)),h.obj(s.to)||(s=L({},s,{to:void 0})),Ms(n,s,i=>As(i))}),Ps(t,n),n}function Ps(t,e){J(e,(n,s)=>{t.springs[s]||(t.springs[s]=n,Be(n,t))})}function As(t,e){const n=new ur;return n.key=t,e&&Be(n,e),n}function Ms(t,e,n){e.keys&&k(e.keys,s=>{(t[s]||(t[s]=n(s)))._prepareNode(e)})}function Ts(t,e){k(e,n=>{Ms(t.springs,n,s=>As(s,t))})}function pr(t,e){if(t==null)return{};var n={},s=Object.keys(t),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}const gr=["children"],ft=t=>{let{children:e}=t,n=pr(t,gr);const s=l.useContext(nt),i=n.pause||!!s.pause,r=n.immediate||!!s.immediate;n=Gi(()=>({pause:i,immediate:r}),[i,r]);const{Provider:o}=nt;return l.createElement(o,{value:n},e)},nt=_r(ft,{});ft.Provider=nt.Provider;ft.Consumer=nt.Consumer;function _r(t,e){return Object.assign(t,l.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}const yr=()=>{const t=[],e=function(i){ji();const r=[];return k(t,(o,a)=>{if(h.und(i))r.push(o.start());else{const u=n(i,o,a);u&&r.push(o.start(u))}}),r};e.current=t,e.add=function(s){t.includes(s)||t.push(s)},e.delete=function(s){const i=t.indexOf(s);~i&&t.splice(i,1)},e.pause=function(){return k(t,s=>s.pause(...arguments)),this},e.resume=function(){return k(t,s=>s.resume(...arguments)),this},e.set=function(s){k(t,i=>i.set(s))},e.start=function(s){const i=[];return k(t,(r,o)=>{if(h.und(s))i.push(r.start());else{const a=this._getProps(s,r,o);a&&i.push(r.start(a))}}),i},e.stop=function(){return k(t,s=>s.stop(...arguments)),this},e.update=function(s){return k(t,(i,r)=>i.update(this._getProps(s,i,r))),this};const n=function(i,r,o){return h.fun(i)?i(o,r):i};return e._getProps=n,e};function vr(t,e,n){const s=h.fun(e)&&e;s&&!n&&(n=[]);const i=l.useMemo(()=>s||arguments.length==3?yr():void 0,[]),r=l.useRef(0),o=ms(),a=l.useMemo(()=>({ctrls:[],queue:[],flush(_,w){const d=An(_,w);return r.current>0&&!a.queue.length&&!Object.keys(d).some(I=>!_.springs[I])?Ct(_,w):new Promise(I=>{Ps(_,d),a.queue.push(()=>{I(Ct(_,w))}),o()})}}),[]),u=l.useRef([...a.ctrls]),c=[],f=pn(t)||0;l.useMemo(()=>{k(u.current.slice(t,f),_=>{nr(_,i),_.stop(!0)}),u.current.length=t,p(f,t)},[t]),l.useMemo(()=>{p(0,Math.min(f,t))},n);function p(_,w){for(let d=_;d<w;d++){const y=u.current[d]||(u.current[d]=new mr(null,a.flush)),I=s?s(d,y):e[d];I&&(c[d]=fr(I))}}const g=u.current.map((_,w)=>An(_,c[w])),x=l.useContext(ft),v=pn(x),b=x!==v&&tr(x);Kt(()=>{r.current++,a.ctrls=u.current;const{queue:_}=a;_.length&&(a.queue=[],k(_,w=>w())),k(u.current,(w,d)=>{i==null||i.add(w),b&&w.start({default:x});const y=c[d];y&&(sr(w,y.ref),w.ref?w.queue.push(y):w.start(y))})}),ps(()=>()=>{k(a.ctrls,_=>_.stop(!0))});const m=g.map(_=>L({},_));return i?[m,i]:m}function br(t,e){const n=h.fun(t),[[s],i]=vr(1,n?t:[t],n?e||[]:e);return n||arguments.length==2?[s,i]:s}let Mn;(function(t){t.MOUNT="mount",t.ENTER="enter",t.UPDATE="update",t.LEAVE="leave"})(Mn||(Mn={}));class wr extends Jt{constructor(e,n){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=Re(...n);const s=this._get(),i=Pt(s);Qt(this,i.create(s))}advance(e){const n=this._get(),s=this.get();Z(n,s)||(q(this).setValue(n),this._onChange(n,this.idle)),!this.idle&&Tn(this._active)&&vt(this)}_get(){const e=h.arr(this.source)?this.source.map(B):$(B(this.source));return this.calc(...e)}_start(){this.idle&&!Tn(this._active)&&(this.idle=!1,k(ut(this),e=>{e.done=!1}),K.skipAnimation?(M.batchedUpdates(()=>this.advance()),vt(this)):rt.start(this))}_attach(){let e=1;k($(this.source),n=>{H(n)&&Be(n,this),Tt(n)&&(n.idle||this._active.add(n),e=Math.max(e,n.priority+1))}),this.priority=e,this._start()}_detach(){k($(this.source),e=>{H(e)&&Je(e,this)}),this._active.clear(),vt(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=$(this.source).reduce((n,s)=>Math.max(n,(Tt(s)?s.priority:0)+1),0))}}function Er(t){return t.idle!==!1}function Tn(t){return!t.size||Array.from(t).every(Er)}function vt(t){t.idle||(t.idle=!0,k(ut(t),e=>{e.done=!0}),Ze(t,{type:"idle",parent:t}))}K.assign({createStringInterpolator:ds,to:(t,e)=>new wr(t,e)});const xr=["primitive"].concat(Object.keys(Gs).filter(t=>/^[A-Z]/.test(t)).map(t=>t[0].toLowerCase()+t.slice(1)));K.assign({createStringInterpolator:ds,colors:gi,frameLoop:"demand"});Ns(()=>{M.advance()});const Ir=Yi(xr,{applyAnimatedValues:zs}),Sr=Ir.animated;function Pr(t,e,n){return Math.max(e,Math.min(t,n))}const C={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function Rn(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function kn(t,e,n,s=.15){return s===0?Pr(t,e,n):t<e?-Rn(e-t,n-e,s)+e:t>n?+Rn(t-n,n-e,s)+n:t}function Ar(t,[e,n],[s,i]){const[[r,o],[a,u]]=t;return[kn(e,r,o,s),kn(n,a,u,i)]}function Mr(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t){var e=Mr(t,"string");return typeof e=="symbol"?e:String(e)}function D(t,e,n){return e=Tr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Cn(Object(n),!0).forEach(function(s){D(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const Rs={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function On(t){return t?t[0].toUpperCase()+t.slice(1):""}const Rr=["enter","leave"];function kr(t=!1,e){return t&&!Rr.includes(e)}function Cr(t,e="",n=!1){const s=Rs[t],i=s&&s[e]||e;return"on"+On(t)+On(i)+(kr(n,i)?"Capture":"")}const Or=["gotpointercapture","lostpointercapture"];function Dr(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const s=Or.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(s);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:n}}function Vr(t,e=""){const n=Rs[t],s=n&&n[e]||e;return t+s}function lt(t){return"touches"in t}function ks(t){return lt(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function Lr(t){return Array.from(t.touches).filter(e=>{var n,s;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(s=n.contains)===null||s===void 0?void 0:s.call(n,e.target))})}function Fr(t){return t.type==="touchend"||t.type==="touchcancel"?t.changedTouches:t.targetTouches}function Cs(t){return lt(t)?Fr(t)[0]:t}function Ot(t,e){const n=e.clientX-t.clientX,s=e.clientY-t.clientY,i=(e.clientX+t.clientX)/2,r=(e.clientY+t.clientY)/2,o=Math.hypot(n,s);return{angle:-(Math.atan2(n,s)*180)/Math.PI,distance:o,origin:[i,r]}}function Br(t){return Lr(t).map(e=>e.identifier)}function Dn(t,e){const[n,s]=Array.from(t.touches).filter(i=>e.includes(i.identifier));return Ot(n,s)}function bt(t){const e=Cs(t);return lt(t)?e.identifier:e.pointerId}function ge(t){const e=Cs(t);return[e.clientX,e.clientY]}const Vn=40,Ln=800;function Os(t){let{deltaX:e,deltaY:n,deltaMode:s}=t;return s===1?(e*=Vn,n*=Vn):s===2&&(e*=Ln,n*=Ln),[e,n]}function Ur(t){var e,n;const{scrollX:s,scrollY:i,scrollLeft:r,scrollTop:o}=t.currentTarget;return[(e=s??r)!==null&&e!==void 0?e:0,(n=i??o)!==null&&n!==void 0?n:0]}function jr(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:s,metaKey:i,ctrlKey:r}=t;Object.assign(e,{shiftKey:n,altKey:s,metaKey:i,ctrlKey:r})}return e}function st(t,...e){return typeof t=="function"?t(...e):t}function $r(){}function Gr(...t){return t.length===0?$r:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function Fn(t,e){return Object.assign({},e,t||{})}const Nr=32;class Ds{constructor(e,n,s){this.ctrl=e,this.args=n,this.key=s,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:s,args:i}=this;n[s]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,s=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=s.from?st(s.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:s,shared:i}=this;n.args=this.args;let r=0;if(e&&(n.event=e,s.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,jr(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,r=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const E=n._delta.map(Math.abs);C.addTo(n._distance,E)}this.axisIntent&&this.axisIntent(e);const[o,a]=n._movement,[u,c]=s.threshold,{_step:f,values:p}=n;if(s.hasCustomTransform?(f[0]===!1&&(f[0]=Math.abs(o)>=u&&p[0]),f[1]===!1&&(f[1]=Math.abs(a)>=c&&p[1])):(f[0]===!1&&(f[0]=Math.abs(o)>=u&&Math.sign(o)*u),f[1]===!1&&(f[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=f[0]!==!1||f[1]!==!1,!n.intentional)return;const g=[0,0];if(s.hasCustomTransform){const[E,T]=p;g[0]=f[0]!==!1?E-f[0]:0,g[1]=f[1]!==!1?T-f[1]:0}else g[0]=f[0]!==!1?o-f[0]:0,g[1]=f[1]!==!1?a-f[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(g);const x=n.offset,v=n._active&&!n._blocked||n.active;v&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,e&&(n.first&&("bounds"in s&&(n._bounds=st(s.bounds,n)),this.setup&&this.setup()),n.movement=g,this.computeOffset()));const[b,m]=n.offset,[[_,w],[d,y]]=n._bounds;n.overflow=[b<_?-1:b>w?1:0,m<d?-1:m>y?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const I=n._active?s.rubberband||[0,0]:[0,0];if(n.offset=Ar(n._bounds,n.offset,I),n.delta=C.sub(n.offset,x),this.computeMovement(),v&&(!n.last||r>Nr)){n.delta=C.sub(n.offset,x);const E=n.delta.map(Math.abs);C.addTo(n.distance,E),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&r>0&&(n.velocity=[E[0]/r,E[1]/r])}}emit(){const e=this.state,n=this.shared,s=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!s.triggerAllEvents)return;const i=this.handler(O(O(O({},n),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function zr([t,e],n){const s=Math.abs(t),i=Math.abs(e);if(s>i&&s>n)return"x";if(i>s&&i>n)return"y"}class Ue extends Ds{constructor(...e){super(...e),D(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=C.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=C.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,s=this.config;if(!n.axis&&e){const i=typeof s.axisThreshold=="object"?s.axisThreshold[ks(e)]:s.axisThreshold;n.axis=zr(n._movement,i)}n._blocked=(s.lockDirection||!!s.axis)&&!n.axis||!!s.axis&&s.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const qr=t=>t,Bn=.15,Vs={enabled(t=!0){return t},eventOptions(t,e,n){return O(O({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[Bn,Bn];case!1:return[0,0];default:return C.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return C.toVector(t)},transform(t,e,n){const s=t||n.shared.transform;return this.hasCustomTransform=!!s,s||qr},threshold(t){return C.toVector(t,0)}},Hr=0,ce=O(O({},Vs),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=Hr){return t},bounds(t={}){if(typeof t=="function")return r=>ce.bounds(t(r));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:s=-1/0,bottom:i=1/0}=t;return[[e,n],[s,i]]}}),Un={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]};class Kr extends Ue{constructor(...e){super(...e),D(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),s=e.currentTarget.getBoundingClientRect(),i={left:n.left-s.left+e.offset[0],right:n.right-s.right+e.offset[0],top:n.top-s.top+e.offset[1],bottom:n.bottom-s.bottom+e.offset[1]};e._bounds=ce.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,s=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&s._pointerActive)&&(this.start(e),this.setupPointer(e),s._pointerId=bt(e),s._pointerActive=!0,this.computeValues(ge(e)),this.computeInitial(),n.preventScrollAxis&&ks(e)!=="mouse"?(s._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,s=this.config;if(!n._pointerActive||n.type===e.type&&e.timeStamp===n.timeStamp)return;const i=bt(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;const r=ge(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=C.sub(r,n._values),this.computeValues(r)),C.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(s.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===s.preventScrollAxis||s.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,s=this.config;if(!n._active||!n._pointerActive)return;const i=bt(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[r,o]=n._distance;if(n.tap=r<=s.tapsThreshold&&o<=s.tapsThreshold,n.tap&&s.filterTaps)n._force=!0;else{const[a,u]=n.direction,[c,f]=n.velocity,[p,g]=n.movement,[x,v]=s.swipe.velocity,[b,m]=s.swipe.distance,_=s.swipe.duration;n.elapsedTime<_&&(Math.abs(c)>x&&Math.abs(p)>b&&(n.swipe[0]=a),Math.abs(f)>v&&Math.abs(g)>m&&(n.swipe[1]=u))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,s=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,s,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,s,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,s,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Qr(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=Un[e.key];if(n){const s=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),s._delta=n(this.config.keyboardDisplacement,i),s._keyboardActive=!0,C.addTo(s._movement,s._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Un&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Qr(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const je=typeof window<"u"&&window.document&&window.document.createElement;function Wr(){return je&&"ontouchstart"in window}function jn(){return Wr()||je&&window.navigator.maxTouchPoints>1}function Yr(){return je&&"onpointerdown"in window}function Xr(){return je&&"exitPointerLock"in window.document}function Zr(){try{return"constructor"in GestureEvent}catch{return!1}}const U={isBrowser:je,gesture:Zr(),touch:jn(),touchscreen:jn(),pointer:Yr(),pointerLock:Xr()},Jr=250,eo=180,to=.5,no=50,so=250,io=10,$n={mouse:0,touch:0,pen:8},ro=O(O({},ce),{},{device(t,e,{pointer:{touch:n=!1,lock:s=!1,mouse:i=!1}={}}){return this.pointerLock=s&&U.pointerLock,U.touch&&n?"touch":this.pointerLock?"mouse":U.pointer&&!i?"pointer":U.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?Jr:void 0,!(!U.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:s=1,keys:i=!0}={}}){return this.pointerButtons=s,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:s=3,axis:i=void 0}){const r=C.toVector(t,n?s:i?1:0);return this.filterTaps=n,this.tapsThreshold=s,r},swipe({velocity:t=to,distance:e=no,duration:n=so}={}){return{velocity:this.transform(C.toVector(t)),distance:this.transform(C.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return eo;case!1:return 0;default:return t}},axisThreshold(t){return t?O(O({},$n),t):$n},keyboardDisplacement(t=io){return t}});function Ls(t){const[e,n]=t.overflow,[s,i]=t._delta,[r,o]=t._direction;(e<0&&s>0&&r<0||e>0&&s<0&&r>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&i>0&&o<0||n>0&&i<0&&o>0)&&(t._movement[1]=t._movementBound[1])}const oo=30,ao=100;class co extends Ds{constructor(...e){super(...e),D(this,"ingKey","pinching"),D(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:s}=this.state;e==="wheel"?this.state.offset=C.add(n,s):this.state.offset=[(1+n[0])*s[0],n[1]+s[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,s]=e._movement;if(!e.axis){const i=Math.abs(n)*oo-Math.abs(s);i<0?e.axis="angle":i>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,s=this.ctrl.touchIds;if(n._active&&n._touchIds.every(r=>s.has(r))||s.size<2)return;this.start(e),n._touchIds=Array.from(s).slice(0,2);const i=Dn(e,n._touchIds);this.pinchStart(e,i)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,s=n._pointerEvents,i=this.ctrl.pointerIds;if(n._active&&Array.from(s.keys()).every(o=>i.has(o))||(s.size<2&&s.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const r=Ot(...Array.from(s.values()));this.pinchStart(e,r)}pinchStart(e,n){const s=this.state;s.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=Dn(e,this.state._touchIds);this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const s=Ot(...Array.from(n.values()));this.pinchMove(e,s)}pinchMove(e,n){const s=this.state,i=s._values[1],r=n.angle-i;let o=0;Math.abs(r)>270&&(o+=Math.sign(r)),this.computeValues([n.distance,n.angle-360*o]),s.origin=n.origin,s.turns=o,s._movement=[s._values[0]/s._initial[0]-1,s._values[1]-s._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const s=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=C.sub(n._movement,s),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&!e[n]||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const s=this.state;s._delta=[-Os(e)[1]/ao*s.offset[0],0],C.addTo(s._movement,s._delta),Ls(s),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const uo=O(O({},Vs),{},{device(t,e,{shared:n,pointer:{touch:s=!1}={}}){if(n.target&&!U.touch&&U.gesture)return"gesture";if(U.touch&&s)return"touch";if(U.touchscreen){if(U.pointer)return"pointer";if(U.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:s={}}){const i=o=>{const a=Fn(st(n,o),{min:-1/0,max:1/0});return[a.min,a.max]},r=o=>{const a=Fn(st(s,o),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof s!="function"?[i(),r()]:o=>[i(o),r(o)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",C.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});class fo extends Ue{constructor(...e){super(...e),D(this,"ingKey","moving")}move(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(ge(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;const n=ge(e),s=this.state;s._delta=C.sub(n,s._values),C.addTo(s._movement,s._delta),this.computeValues(n),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}const lo=O(O({},ce),{},{mouseOnly:(t=!0)=>t});class ho extends Ue{constructor(...e){super(...e),D(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();const n=this.state,s=Ur(e);n._delta=C.sub(s,n._values),C.addTo(n._movement,n._delta),this.computeValues(s),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}}const mo=ce;class po extends Ue{constructor(...e){super(...e),D(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=Os(e),C.addTo(n._movement,n._delta),Ls(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const go=ce;class _o extends Ue{constructor(...e){super(...e),D(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&e.pointerType!=="mouse"||(this.start(e),this.computeValues(ge(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&e.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const s=ge(e);n._movement=n._delta=C.sub(s,n._values),this.computeValues(s),this.compute(e),n.delta=n.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}const yo=O(O({},ce),{},{mouseOnly:(t=!0)=>t}),en=new Map,Dt=new Map;function vo(t){en.set(t.key,t.engine),Dt.set(t.key,t.resolver)}const bo={key:"drag",engine:Kr,resolver:ro},wo={key:"hover",engine:_o,resolver:yo},Eo={key:"move",engine:fo,resolver:lo},xo={key:"pinch",engine:co,resolver:uo},Io={key:"scroll",engine:ho,resolver:mo},So={key:"wheel",engine:po,resolver:go};function Po(t,e){if(t==null)return{};var n={},s=Object.keys(t),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Ao(t,e){if(t==null)return{};var n=Po(t,e),s,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}const Mo={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=U.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},To=["target","eventOptions","window","enabled","transform"];function Ke(t={},e){const n={};for(const[s,i]of Object.entries(e))switch(typeof i){case"function":n[s]=i.call(n,t[s],s,t);break;case"object":n[s]=Ke(t[s],i);break;case"boolean":i&&(n[s]=t[s]);break}return n}function Ro(t,e,n={}){const s=t,{target:i,eventOptions:r,window:o,enabled:a,transform:u}=s,c=Ao(s,To);if(n.shared=Ke({target:i,eventOptions:r,window:o,enabled:a,transform:u},Mo),e){const f=Dt.get(e);n[e]=Ke(O({shared:n.shared},c),f)}else for(const f in c){const p=Dt.get(f);p&&(n[f]=Ke(O({shared:n.shared},c[f]),p))}return n}class Fs{constructor(e,n){D(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,s,i,r){const o=this._listeners,a=Vr(n,s),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=O(O({},u),r);e.addEventListener(a,i,c);const f=()=>{e.removeEventListener(a,i,c),o.delete(f)};return o.add(f),f}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class ko{constructor(){D(this,"_timeouts",new Map)}add(e,n,s=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(n,s,...i))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class Co{constructor(e){D(this,"gestures",new Set),D(this,"_targetEventStore",new Fs(this)),D(this,"gestureEventStores",{}),D(this,"gestureTimeoutStores",{}),D(this,"handlers",{}),D(this,"config",{}),D(this,"pointerIds",new Set),D(this,"touchIds",new Set),D(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Oo(this,e)}setEventIds(e){if(lt(e))return this.touchIds=new Set(Br(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=Ro(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,s={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const o of this.gestures){const a=this.config[o],u=Gn(s,a.eventOptions,!!i);if(a.enabled){const c=en.get(o);new c(this,e,o).bind(u)}}const r=Gn(s,n.eventOptions,!!i);for(const o in this.nativeHandlers)r(o,"",a=>this.nativeHandlers[o](O(O({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const r in s)s[r]=Gr(...s[r]);if(!i)return s;for(const r in s){const{device:o,capture:a,passive:u}=Dr(r);this._targetEventStore.add(i,o,"",s[r],{capture:a,passive:u})}}}}function fe(t,e){t.gestures.add(e),t.gestureEventStores[e]=new Fs(t,e),t.gestureTimeoutStores[e]=new ko}function Oo(t,e){e.drag&&fe(t,"drag"),e.wheel&&fe(t,"wheel"),e.scroll&&fe(t,"scroll"),e.move&&fe(t,"move"),e.pinch&&fe(t,"pinch"),e.hover&&fe(t,"hover")}const Gn=(t,e,n)=>(s,i,r,o={},a=!1)=>{var u,c;const f=(u=o.capture)!==null&&u!==void 0?u:e.capture,p=(c=o.passive)!==null&&c!==void 0?c:e.passive;let g=a?s:Cr(s,i,f);n&&p&&(g+="Passive"),t[g]=t[g]||[],t[g].push(r)},Do=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Vo(t){const e={},n={},s=new Set;for(let i in t)Do.test(i)?(s.add(RegExp.lastMatch),n[i]=t[i]):e[i]=t[i];return[n,e,s]}function le(t,e,n,s,i,r){if(!t.has(n)||!en.has(s))return;const o=n+"Start",a=n+"End",u=c=>{let f;return c.first&&o in e&&e[o](c),n in e&&(f=e[n](c)),c.last&&a in e&&e[a](c),f};i[s]=u,r[s]=r[s]||{}}function Lo(t,e){const[n,s,i]=Vo(t),r={};return le(i,n,"onDrag","drag",r,e),le(i,n,"onWheel","wheel",r,e),le(i,n,"onScroll","scroll",r,e),le(i,n,"onPinch","pinch",r,e),le(i,n,"onMove","move",r,e),le(i,n,"onHover","hover",r,e),{handlers:r,config:e,nativeHandlers:s}}function Fo(t,e={},n,s){const i=ht.useMemo(()=>new Co(t),[]);if(i.applyHandlers(t,s),i.applyConfig(e,n),ht.useEffect(i.effect.bind(i)),ht.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function Bo(t){return t.forEach(vo),function(n,s){const{handlers:i,nativeHandlers:r,config:o}=Lo(n,s||{});return Fo(i,o,void 0,r)}}function Uo(t,e){return Bo([bo,xo,Io,So,Eo,wo])(t,e||{})}function jo({enabled:t=!0,snap:e,global:n,domElement:s,cursor:i=!0,children:r,speed:o=1,rotation:a=[0,0,0],zoom:u=1,polar:c=[0,Math.PI/2],azimuth:f=[-1/0,1/0],config:p={mass:1,tension:170,friction:26}}){const g=re(E=>E.events),x=re(E=>E.gl),v=s||g.connected||x.domElement,{size:b}=re(),m=l.useMemo(()=>[a[0]+c[0],a[0]+c[1]],[a[0],c[0],c[1]]),_=l.useMemo(()=>[a[1]+f[0],a[1]+f[1]],[a[1],f[0],f[1]]),w=l.useMemo(()=>[xe.clamp(a[0],...m),xe.clamp(a[1],..._),a[2]],[a[0],a[1],a[2],m,_]),[d,y]=br(()=>({scale:1,rotation:w,config:p}));l.useEffect(()=>void y.start({scale:1,rotation:w,config:p}),[w]),l.useEffect(()=>(n&&i&&t&&(v.style.cursor="grab",x.domElement.style.cursor=""),()=>{v.style.cursor="default",x.domElement.style.cursor="default"}),[n,i,v,t]);const I=Uo({onHover:({last:E})=>{i&&!n&&t&&(v.style.cursor=E?"auto":"grab")},onDrag:({down:E,delta:[T,P],memo:[A,R]=d.rotation.animation.to||w})=>{if(!t)return[P,T];i&&(v.style.cursor=E?"grabbing":"grab"),T=xe.clamp(R+T/b.width*Math.PI*o,..._),P=xe.clamp(A+P/b.height*Math.PI*o,...m);const S=e&&!E&&typeof e!="boolean"?e:p;return y.start({scale:E&&P>m[1]/2?u:1,rotation:e&&!E?w:[P,T,0],config:V=>V==="scale"?{...S,friction:S.friction*3}:S}),[P,T]}},{target:n?v:void 0});return l.createElement(Sr.group,Te({},I==null?void 0:I(),d),r)}const $o=t=>t&&t.isCubeTexture;class Go extends Yn{constructor(e,n){var s,i;const r=$o(e),a=((s=r?(i=e.image[0])===null||i===void 0?void 0:i.width:e.image.width)!=null?s:1024)/4,u=Math.floor(Math.log2(a)),c=Math.pow(2,u),f=3*Math.max(c,16*7),p=4*c,g=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/f}`,`#define CUBEUV_TEXEL_HEIGHT ${1/p}`,`#define CUBEUV_MAX_MIP ${u}.0`],x=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,v=g.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <encodings_fragment>
        }
        `,b={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},m=new qs(1,16),_=new Hs({uniforms:b,fragmentShader:v,vertexShader:x,side:Ks});super(m,_)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}class No extends Qs{constructor(e){super(e),this.type=Ie}parse(e){const a=function(d,y){switch(d){case 1:console.error("THREE.RGBELoader Read Error: "+(y||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(y||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(y||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(y||""))}return-1},p=`
`,g=function(d,y,I){y=y||1024;let T=d.pos,P=-1,A=0,R="",S=String.fromCharCode.apply(null,new Uint16Array(d.subarray(T,T+128)));for(;0>(P=S.indexOf(p))&&A<y&&T<d.byteLength;)R+=S,A+=S.length,T+=128,S+=String.fromCharCode.apply(null,new Uint16Array(d.subarray(T,T+128)));return-1<P?(I!==!1&&(d.pos+=A+P+1),R+S.slice(0,P)):!1},x=function(d){const y=/^#\?(\S+)/,I=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,E=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,T=/^\s*FORMAT=(\S+)\s*$/,P=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,A={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let R,S;if(d.pos>=d.byteLength||!(R=g(d)))return a(1,"no header found");if(!(S=R.match(y)))return a(3,"bad initial token");for(A.valid|=1,A.programtype=S[1],A.string+=R+`
`;R=g(d),R!==!1;){if(A.string+=R+`
`,R.charAt(0)==="#"){A.comments+=R+`
`;continue}if((S=R.match(I))&&(A.gamma=parseFloat(S[1])),(S=R.match(E))&&(A.exposure=parseFloat(S[1])),(S=R.match(T))&&(A.valid|=2,A.format=S[1]),(S=R.match(P))&&(A.valid|=4,A.height=parseInt(S[1],10),A.width=parseInt(S[2],10)),A.valid&2&&A.valid&4)break}return A.valid&2?A.valid&4?A:a(3,"missing image size specifier"):a(3,"missing format specifier")},v=function(d,y,I){const E=y;if(E<8||E>32767||d[0]!==2||d[1]!==2||d[2]&128)return new Uint8Array(d);if(E!==(d[2]<<8|d[3]))return a(3,"wrong scanline width");const T=new Uint8Array(4*y*I);if(!T.length)return a(4,"unable to allocate buffer space");let P=0,A=0;const R=4*E,S=new Uint8Array(4),V=new Uint8Array(R);let Q=I;for(;Q>0&&A<d.byteLength;){if(A+4>d.byteLength)return a(1);if(S[0]=d[A++],S[1]=d[A++],S[2]=d[A++],S[3]=d[A++],S[0]!=2||S[1]!=2||(S[2]<<8|S[3])!=E)return a(3,"bad rgbe scanline format");let W=0,G;for(;W<R&&A<d.byteLength;){G=d[A++];const Y=G>128;if(Y&&(G-=128),G===0||W+G>R)return a(3,"bad scanline data");if(Y){const X=d[A++];for(let nn=0;nn<G;nn++)V[W++]=X}else V.set(d.subarray(A,A+G),W),W+=G,A+=G}const $s=E;for(let Y=0;Y<$s;Y++){let X=0;T[P]=V[Y+X],X+=E,T[P+1]=V[Y+X],X+=E,T[P+2]=V[Y+X],X+=E,T[P+3]=V[Y+X],P+=4}Q--}return T},b=function(d,y,I,E){const T=d[y+3],P=Math.pow(2,T-128)/255;I[E+0]=d[y+0]*P,I[E+1]=d[y+1]*P,I[E+2]=d[y+2]*P,I[E+3]=1},m=function(d,y,I,E){const T=d[y+3],P=Math.pow(2,T-128)/255;I[E+0]=$e.toHalfFloat(Math.min(d[y+0]*P,65504)),I[E+1]=$e.toHalfFloat(Math.min(d[y+1]*P,65504)),I[E+2]=$e.toHalfFloat(Math.min(d[y+2]*P,65504)),I[E+3]=$e.toHalfFloat(1)},_=new Uint8Array(e);_.pos=0;const w=x(_);if(w!==-1){const d=w.width,y=w.height,I=v(_.subarray(_.pos),d,y);if(I!==-1){let E,T,P;switch(this.type){case mt:P=I.length/4;const A=new Float32Array(P*4);for(let S=0;S<P;S++)b(I,S*4,A,S*4);E=A,T=mt;break;case Ie:P=I.length/4;const R=new Uint16Array(P*4);for(let S=0;S<P;S++)m(I,S*4,R,S*4);E=R,T=Ie;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:d,height:y,data:E,header:w.string,gamma:w.gamma,exposure:w.exposure,type:T}}}return null}setDataType(e){return this.type=e,this}load(e,n,s,i){function r(o,a){switch(o.type){case mt:case Ie:o.encoding=Xn,o.minFilter=sn,o.magFilter=sn,o.generateMipmaps=!1,o.flipY=!0;break}n&&n(o,a)}return super.load(e,r,s,i)}}const zo=l.forwardRef(({children:t,speed:e=1,rotationIntensity:n=1,floatIntensity:s=1,floatingRange:i=[-.1,.1],...r},o)=>{const a=l.useRef(null),u=l.useRef(Math.random()*1e4);return Lt(c=>{var f,p;const g=u.current+c.clock.getElapsedTime();a.current.rotation.x=Math.cos(g/4*e)/8*n,a.current.rotation.y=Math.sin(g/4*e)/8*n,a.current.rotation.z=Math.sin(g/4*e)/20*n;let x=Math.sin(g/4*e)/10;x=xe.mapLinear(x,-.1,.1,(f=i==null?void 0:i[0])!==null&&f!==void 0?f:-.1,(p=i==null?void 0:i[1])!==null&&p!==void 0?p:.1),a.current.position.y=x*s}),l.createElement("group",r,l.createElement("group",{ref:Ft([a,o])},t))}),wt={sunset:"venice/venice_sunset_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",night:"dikhololo/dikhololo_night_1k.hdr",warehouse:"empty-wharehouse/empty_warehouse_01_1k.hdr",forest:"forrest-slope/forest_slope_1k.hdr",apartment:"lebombo/lebombo_1k.hdr",studio:"studio-small-3/studio_small_03_1k.hdr",city:"potsdamer-platz/potsdamer_platz_1k.hdr",park:"rooitou/rooitou_park_1k.hdr",lobby:"st-fagans/st_fagans_interior_1k.hdr"},qo="https://market-assets.fra1.cdn.digitaloceanspaces.com/market-assets/hdris/",Ho=t=>t.current&&t.current.isScene,Ko=t=>Ho(t)?t.current:t;function tn(t,e,n,s,i=0){const r=Ko(e||n),o=r.background,a=r.environment,u=r.backgroundBlurriness||0;return t!=="only"&&(r.environment=s),t&&(r.background=s),t&&r.backgroundBlurriness!==void 0&&(r.backgroundBlurriness=i),()=>{t!=="only"&&(r.environment=a),t&&(r.background=o),t&&r.backgroundBlurriness!==void 0&&(r.backgroundBlurriness=u)}}function dt({scene:t,background:e=!1,blur:n,map:s}){const i=re(r=>r.scene);return l.useLayoutEffect(()=>{if(s)return tn(e,t,i,s,n)},[i,t,s,e,n]),null}function Bs({files:t=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:e="",preset:n=void 0,encoding:s=void 0,extensions:i}){if(n){if(!(n in wt))throw new Error("Preset must be one of: "+Object.keys(wt).join(", "));t=wt[n],e=qo}const r=Array.isArray(t),a=Zs(r?ni:No,r?[t]:t,c=>{c.setPath(e),i&&i(c)}),u=r?a[0]:a;return u.mapping=r?Js:ei,u.encoding=s??r?ti:Xn,u}function Us({background:t=!1,scene:e,blur:n,...s}){const i=Bs(s),r=re(o=>o.scene);return l.useLayoutEffect(()=>tn(t,e,r,i,n),[i,t,e,r,n]),null}function Qo({children:t,near:e=1,far:n=1e3,resolution:s=256,frames:i=1,map:r,background:o=!1,blur:a,scene:u,files:c,path:f,preset:p=void 0,extensions:g}){const x=re(d=>d.gl),v=re(d=>d.scene),b=l.useRef(null),[m]=l.useState(()=>new Ws),_=l.useMemo(()=>{const d=new Ys(s);return d.texture.type=Ie,d},[s]);l.useLayoutEffect(()=>(i===1&&b.current.update(x,m),tn(o,u,v,_.texture,a)),[t,m,_.texture,u,v,o,i,x]);let w=1;return Lt(()=>{(i===1/0||w<i)&&(b.current.update(x,m),w++)}),l.createElement(l.Fragment,null,Xs(l.createElement(l.Fragment,null,t,l.createElement("cubeCamera",{ref:b,args:[e,n,_]}),c||p?l.createElement(Us,{background:!0,files:c,preset:p,path:f,extensions:g}):r?l.createElement(dt,{background:!0,map:r,extensions:g}):null),m))}function Wo(t){var e,n,s,i;const r=Bs(t),o=t.map||r;l.useMemo(()=>Zn({GroundProjectedEnvImpl:Go}),[]);const a=l.useMemo(()=>[o],[o]),u=(e=t.ground)==null?void 0:e.height,c=(n=t.ground)==null?void 0:n.radius,f=(s=(i=t.ground)==null?void 0:i.scale)!==null&&s!==void 0?s:1e3;return l.createElement(l.Fragment,null,l.createElement(dt,Te({},t,{map:o})),l.createElement("groundProjectedEnvImpl",{args:a,scale:f,height:u,radius:c}))}function Yo(t){return t.ground?l.createElement(Wo,t):t.map?l.createElement(dt,t):t.children?l.createElement(Qo,t):l.createElement(Us,t)}ye.func.isRequired,ye.arrayOf(ye.oneOfType([ye.element,ye.func])).isRequired;const Nn=new Ve,zn=new Ve,qe=[],Ee=new Yn;class Xo extends si{constructor(){super(),this.color=new ii("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,n){const s=this.instance.current;if(!s||!s.geometry||!s.material)return;Ee.geometry=s.geometry;const i=s.matrixWorld,r=s.userData.instances.indexOf(this.instanceKey);if(!(r===-1||r>s.count)){s.getMatrixAt(r,Nn),zn.multiplyMatrices(i,Nn),Ee.matrixWorld=zn,s.material instanceof ri?Ee.material.side=s.material.side:Ee.material.side=s.material[0].side,Ee.raycast(e,qe);for(let o=0,a=qe.length;o<a;o++){const u=qe[o];u.instanceId=r,u.object=this,n.push(u)}qe.length=0}}}const js=l.createContext(null),qn=new Ve,Hn=new Ve,Zo=new Ve,Kn=new Jn,Qn=new oi,Wn=new Jn,Vt=l.forwardRef(({context:t,children:e,...n},s)=>{l.useMemo(()=>Zn({PositionMesh:Xo}),[]);const i=l.useRef(),{subscribe:r,getParent:o}=l.useContext(t||js);return l.useLayoutEffect(()=>r(i),[]),l.createElement("positionMesh",Te({instance:o(),instanceKey:i,ref:Ft([s,i])},n),e)}),Jo=l.forwardRef(({children:t,range:e,limit:n=1e3,frames:s=1/0,...i},r)=>{const[{context:o,instance:a}]=l.useState(()=>{const m=l.createContext(null);return{context:m,instance:l.forwardRef((_,w)=>l.createElement(Vt,Te({context:m},_,{ref:w})))}}),u=l.useRef(null),[c,f]=l.useState([]),[[p,g]]=l.useState(()=>{const m=new Float32Array(n*16);for(let _=0;_<n;_++)Zo.identity().toArray(m,_*16);return[m,new Float32Array([...new Array(n*3)].map(()=>1))]});l.useEffect(()=>{u.current.instanceMatrix.needsUpdate=!0});let x=0,v=0;Lt(()=>{if(s===1/0||x<s){u.current.updateMatrix(),u.current.updateMatrixWorld(),qn.copy(u.current.matrixWorld).invert(),v=Math.min(n,e!==void 0?e:n,c.length),u.current.count=v,u.current.instanceMatrix.updateRange.count=v*16,u.current.instanceColor.updateRange.count=v*3;for(let m=0;m<c.length;m++){const _=c[m].current;_.matrixWorld.decompose(Kn,Qn,Wn),Hn.compose(Kn,Qn,Wn).premultiply(qn),Hn.toArray(p,m*16),u.current.instanceMatrix.needsUpdate=!0,_.color.toArray(g,m*3),u.current.instanceColor.needsUpdate=!0}x++}});const b=l.useMemo(()=>({getParent:()=>u,subscribe:m=>(f(_=>[..._,m]),()=>f(_=>_.filter(w=>w.current!==m.current)))}),[]);return l.createElement("instancedMesh",Te({userData:{instances:c},matrixAutoUpdate:!1,ref:Ft([r,u]),args:[null,null,0],raycast:()=>null},i),l.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:p.length/16,array:p,itemSize:16,usage:rn}),l.createElement("instancedBufferAttribute",{attach:"instanceColor",count:g.length/3,array:g,itemSize:3,usage:rn}),typeof t=="function"?l.createElement(o.Provider,{value:b},t(a)):l.createElement(js.Provider,{value:b},t))}),ea=l.lazy(()=>es(()=>import("./DogModel-096c9bbc.js"),["assets/DogModel-096c9bbc.js","assets/index-2b7fac79.js","assets/index-19cfe20c.css","assets/useGLTF-805efb26.js"])),ta=l.lazy(()=>es(()=>import("./DuckModel-66caaa8c.js"),["assets/DuckModel-66caaa8c.js","assets/index-2b7fac79.js","assets/index-19cfe20c.css","assets/useGLTF-805efb26.js"])),oa=()=>{const t=ai(ui),e={scale:2.2,"position-y":-2,rotation:[-.25,.2,0],"position-x":-.25};return Qe(ci,{children:[F("color",{attach:"background",args:["#f2f2f5"]}),F(dt,{preset:"city"}),F(Yo,{preset:"city"}),F("ambientLight",{intensity:.4}),F(jo,{global:!0,speed:2,polar:[-.4,.2],azimuth:[-1,.75],config:{mass:2,tension:400},snap:{mass:4,tension:400},children:F(zo,{rotationIntensity:.5,children:Qe(l.Suspense,{children:[t.model==="duck"&&F(ta,{...e}),t.model==="dog"&&F(ea,{...e})]})})}),F(l.Suspense,{children:F(na,{})})]})},na=({number:t=20,lineWidth:e=.05,height:n=.5})=>Qe(Jo,{position:[0,-2.05,0],receiveShadow:!0,children:[F("planeGeometry",{args:[e,n]}),F("meshBasicMaterial",{color:"#888"}),Array.from({length:t},(s,i)=>Array.from({length:t},(r,o)=>Qe("group",{position:[o*2-Math.floor(t/2)*2,-.01,i*2-Math.floor(t/2)*2],children:[F(Vt,{rotation:[-Math.PI/2,0,0]}),F(Vt,{rotation:[-Math.PI/2,0,Math.PI/2]})]},o+":"+i))),F("gridHelper",{args:[100,100,"#bbb","#bbb"],position:[0,-.01,0]})]});export{oa as default};
